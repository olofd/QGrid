angular.module("ui.bootstrap.typeahead").directive("qgridTypeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(a,b,c,d,e,f,g){var h=[9,13,27,38,40];return{require:"ngModel",link:function(i,j,k,l){var m,n=i.$eval(k.qgridTypeaheadMinLength)||1,o=i.$eval(k.qgridTypeaheadWaitMs)||0,p=i.$eval(k.qgridTypeaheadEditable)!==!1,q=b(k.qgridTypeaheadLoading).assign||angular.noop,r=b(k.qgridTypeaheadOnSelect),s=k.qgridTypeaheadInputFormatter?b(k.qgridTypeaheadInputFormatter):void 0,t=k.qgridTypeaheadAppendToBody?i.$eval(k.qgridTypeaheadAppendToBody):!1,u=b(k.ngModel).assign,v=g.parse(k.qgridTypeahead);j.attr({"aria-autocomplete":"list","aria-expanded":!1});var w=angular.element("<div typeahead-popup></div>");w.attr({matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(k.typeaheadTemplateUrl)&&w.attr("template-url",k.typeaheadTemplateUrl);var x=i.$new();i.$on("$destroy",function(){x.$destroy()});var y=function(){x.matches=[],x.activeIdx=-1},z=function(a){var b={$viewValue:a};q(i,!0),c.when(v.source(i,b)).then(function(c){if(a===l.$viewValue&&m){if(c.length>0){x.activeIdx=-1,x.matches.length=0;for(var d=0;d<c.length;d++)b[v.itemName]=c[d],x.matches.push({label:v.viewMapper(x,b),model:c[d]});x.query=a,x.position=t?f.offset(j):f.position(j),x.position.top=x.position.top+j.prop("offsetHeight")}else y();q(i,!1)}},function(){y(),q(i,!1)})};y(),x.query=void 0;var A;l.$parsers.unshift(function(a){return m=!0,a&&a.length>=n?o>0?(A&&d.cancel(A),A=d(function(){z(a)},o)):z(a):(q(i,!1),y()),p?a:a?void l.$setValidity("editable",!1):(l.$setValidity("editable",!0),a)}),i.openTypeAhead=function(){},l.$formatters.push(function(a){var b,c,d={};return s?(d.$model=a,s(i,d)):(d[v.itemName]=a,b=v.viewMapper(i,d),d[v.itemName]=void 0,c=v.viewMapper(i,d),b!==c?b:a)}),x.select=function(a){console.log(a);var b,c,d={};d[v.itemName]=c=x.matches[a].model,b=v.modelMapper(i,d),u(i,b),l.$setValidity("editable",!0),r(i,{$item:c,$model:b,$label:v.viewMapper(i,d)}),y(),j[0].focus()},j.bind("keydown",function(a){0!==x.matches.length&&-1!==h.indexOf(a.which)&&(a.preventDefault(),40===a.which?(x.activeIdx=(x.activeIdx+1)%x.matches.length,x.$digest()):38===a.which?(x.activeIdx=(x.activeIdx?x.activeIdx:x.matches.length)-1,x.$digest()):13===a.which||9===a.which?x.$apply(function(){-1!==x.activeIdx?x.select(x.activeIdx):(a.stopPropagation(),y())}):27===a.which&&(a.stopPropagation(),y(),x.$digest()))}),j.bind("blur",function(){m=!1});var B=function(a){j[0]!==a.target&&(y(),x.$digest())};e.bind("click",B),i.$on("$destroy",function(){e.unbind("click",B)});var C=a(w)(x);t?e.find("body").append(C):j.after(C)}}}]);var qgrid;!function(a){!function(a){a[a.IsEqualTo=0]="IsEqualTo",a[a.IsNotEqualTo=1]="IsNotEqualTo",a[a.IsLessThan=2]="IsLessThan",a[a.IsLessOrEqualTo=3]="IsLessOrEqualTo",a[a.IsGreaterThan=4]="IsGreaterThan",a[a.IsGreaterOrEqualTo=5]="IsGreaterOrEqualTo",a[a.IsIn=6]="IsIn",a[a.IsNotIn=7]="IsNotIn",a[a.BeginsWith=8]="BeginsWith",a[a.DoesNotBeginWith=9]="DoesNotBeginWith",a[a.EndsWith=10]="EndsWith",a[a.DoesNotEndWith=11]="DoesNotEndWith",a[a.Contains=12]="Contains",a[a.DoesNotContain=13]="DoesNotContain",a[a.ManualFilter=14]="ManualFilter"}(a.SearchOp||(a.SearchOp={}));a.SearchOp;!function(a){a[a.DateTime=0]="DateTime"}(a.DataType||(a.DataType={}));a.DataType;!function(a){a[a.None=0]="None",a[a.SearchTextBox=1]="SearchTextBox",a[a.TypeaheadTexBox=2]="TypeaheadTexBox",a[a.DatePickerTextBox=3]="DatePickerTextBox"}(a.IQGridColumnHeaderStyle||(a.IQGridColumnHeaderStyle={}));a.IQGridColumnHeaderStyle}(qgrid||(qgrid={})),angular.module("qgrid",["ngGrid","ui.bootstrap"]);var qgrid;!function(a){var b=function(){function a(a){"undefined"==typeof a&&(a="yyyy-MM-dd HH:mm:ss"),this.format=a}return Object.defineProperty(a.prototype,"template",{get:function(){return"/src/templates/nggrid/qgrid-datetime-cell.html"},enumerable:!0,configurable:!0}),a}();a.DateTimeCellFormater=b;var c=function(){function a(a){this.gridModel=a}return a}();a.QGridHelper=c}(qgrid||(qgrid={})),angular.module("qgrid").directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter,{event:b})}),b.preventDefault())})}}),angular.module("qgrid").directive("qgrid",["qgridService",function(a){return{scope:{qgrid:"="},templateUrl:"src/templates/qgrid/qgrid.html",controller:["$scope",function(b){a.createGrid(b)}]}}]),angular.module("qgrid").factory("qgridExtender",function(){return{deepExtend:function(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},arguments.callee(a[c],b[c])):a[c]=b[c];return a}}}),angular.module("qgrid").factory("qgridDefaultQgridModel",function(){return{getNewDefault:function(){return{data:"qgrid.qgridSettings.rows",totalServerItems:"qgrid.qgridSettings.totalServerItems",headerRowHeight:75,footerRowHeight:48,headerRowTemplate:"src/templates/nggrid/qgrid-header-row-template.html",footerTemplate:"src/templates/nggrid/qgrid-footer.html",enablePaging:!0,showFooter:!0,enablePinning:!1,multiSelect:!1,useExternalSorting:!0,i18n:"en",pagingOptions:{currentPage:1,pageSize:10,pageSizes:[10,20,50]}}}}}),angular.module("qgrid").factory("qgridDefaultQgridSettings",function(){return{getNewDefault:function(){return{rows:[],gridId:"DefaultGrid",domain:"",urlDataRequest:this.domain+this.gridId+"/DataRequest",urlAutoComplete:this.domain+this.gridId+"/AutoComplete",urlExport:this.domain+this.gridId+"/Export",enableAllExports:!1,enableExcelExport:!1,enablePDFExport:!1,enableCSVExport:!1,enableFooterSettings:!1,totalServerItems:0,isLoading:!1}}}});var qgrid;!function(a){var b=function(){function a(a,b,c,d){this.$http=a,this.$q=b,this.$timeout=c,this.qgridExtender=d,this.createRequestGuid=function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return a(void 0)+a(!0)+a(!0)+a(void 0)}}return a.prototype.constructServcerRequestObject=function(a){var b=this,c={requestInfo:{id:a.qgridSettings.gridId,rows:a.pagingOptions.pageSize,rguid:b.createRequestGuid()}};return c.requestSearchInfo=this.constructRequestSearchObject(a),c.requestInfo.search=this.setIsSearch(c.requestSearchInfo),c.requestInfo.sf=this.findSortField(a),c.requestInfo.sord=this.findSortOrder(a),c.requestInfo.page=c.requestInfo.search?1:a.pagingOptions.currentPage,c},a.prototype.constructRequestSearchObject=function(a){for(var b=!1,c=Array(),d=0;d<a.columnDefs.length;d++){var e=a.columnDefs[d];e.qgridColumnSettings.searchValue&&""!==e.qgridColumnSettings.searchValue&&(b=!0),c.push({n:e.field,so:this.getShortSearchOpertionForSearchOperationEnum(e),v:e.qgridColumnSettings.searchValue,pk:e.primaryKey})}return c},a.prototype.findSortOrder=function(a){return a.sortInfo&&a.sortInfo.directions&&a.sortInfo.directions.length>0?a.sortInfo.directions[0]:void 0},a.prototype.findSortField=function(a){return a.sortInfo&&a.sortInfo.fields&&a.sortInfo.fields.length>0?a.sortInfo.fields[0]:void 0},a.prototype.setIsSearch=function(a){for(var b in a){var c=a[b].v;if(c&&""!==c)return!0}return!1},a.prototype.getShortSearchOpertionForSearchOperationEnum=function(a){return 0===a.qgridColumnSettings.searchOperation?"eq":1===a.qgridColumnSettings.searchOperation?"ne":2===a.qgridColumnSettings.searchOperation?"lt":3===a.qgridColumnSettings.searchOperation?"le":4===a.qgridColumnSettings.searchOperation?"gt":5===a.qgridColumnSettings.searchOperation?"ge":6===a.qgridColumnSettings.searchOperation?"in":7===a.qgridColumnSettings.searchOperation?"ni":8===a.qgridColumnSettings.searchOperation?"bw":9===a.qgridColumnSettings.searchOperation?"bn":10===a.qgridColumnSettings.searchOperation?"ew":11===a.qgridColumnSettings.searchOperation?"en":12===a.qgridColumnSettings.searchOperation?"cn":13===a.qgridColumnSettings.searchOperation?"nc":14===a.qgridColumnSettings.searchOperation?"mf":"bw"},a.$inject=["$http","$q","$timeout","qgridExtender"],a}();a.ServerRequestBuilder=b}(qgrid||(qgrid={})),angular.module("qgrid").service("qgridServerRequestBuilder",qgrid.ServerRequestBuilder);var qgrid;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h){this.$http=a,this.$q=b,this.$timeout=c,this.$interval=d,this.qgridExtender=e,this.qgridServverRequestBuilder=f,this.qgridDefaultQgridModel=g,this.qgridDefaultQgridSettings=h}return a.prototype.createGrid=function(a){var b=this;a.qgrid=this.setupGrid(a.qgrid),a.$watch("qgrid.qgridSettings.isLoaded",function(c){c&&b.$timeout(function(){b.loadGrid(a.qgrid)},0)},!0),a.$watch("qgrid.sortInfo",function(c,d){(c.directions[0]!==d.directions[0]||c.fields[0]!==d.fields[0])&&b.onSort(c,d,a.qgrid)},!0),a.$watch("qgrid.pagingOptions",function(c,d){c!==d&&b.onPaging(c,d,a.qgrid)},!0),a.qgrid.qgridSettings.isLoaded=!0},a.prototype.setupGrid=function(a){var b=this.qgridDefaultQgridModel.getNewDefault(),c=this.qgridDefaultQgridSettings.getNewDefault();b.qgridSettings=c,this.qgridExtender.deepExtend(b,a),b.qgridSettings.loadGrid=function(a,b){return function(){return b.loadGrid(a)}}(b,this),b.qgridSettings.exportGrid=function(a,b){return function(c){return b.exportGrid(c,a)}}(b,this),b.qgridSettings.resetGrid=function(a,b){return function(){return b.resetGrid(a)}}(b,this),b.qgridSettings.autoComplete=function(a,b){return function(c){return b.autoComplete(c,a)}}(b,this);for(var d in b.columnDefs){var e=b.columnDefs[d];e.headerClass||(e.headerClass="qgrid-cell-header"),e.qgridColumnSettings&&e.qgridColumnSettings.cellFormatter&&(e.cellTemplate=e.qgridColumnSettings.cellFormatter.template),2===e.qgridColumnSettings.qgridColumnHeaderStyle&&(e.headerCellTemplate="/src/templates/nggrid/qgrid-typeahead-header-cell.html"),1===e.qgridColumnSettings.qgridColumnHeaderStyle&&(e.headerCellTemplate="/src/templates/nggrid/qgrid-searchtextbox-header-cell.html")}return b},a.prototype.buildServerRequestObject=function(a){return this.qgridServverRequestBuilder.constructServcerRequestObject(a)},a.prototype.performSearch=function(a){return this.loadGrid(a)},a.prototype.requestData=function(a,b){return this.$http.post(b.qgridSettings.domain+b.qgridSettings.urlDataRequest,a)},a.prototype.loadGrid=function(a){var b=this;a.qgridSettings.isLoading=!0;var c=this.$q.defer(),d=this.requestData(this.buildServerRequestObject(a),a);return d.success(function(d){a.qgridSettings.rows=d.rows,a.qgridSettings.totalServerItems=d.records,c.resolve(d),d.page!==a.pagingOptions.currentPage&&(a.pagingOptions.manualPaging=!0,a.pagingOptions.currentPage=d.page,console.log(a.pagingOptions.currentPage),b.$timeout(function(){a.pagingOptions.manualPaging=!1},0)),a.qgridSettings.isLoading=!1}),d.error(function(a){c.reject(a)}),c.promise},a.prototype.onSort=function(a,b,c){return this.loadGrid(c)},a.prototype.onPaging=function(a,b,c){return a.manualPaging?void 0:this.loadGrid(c)},a.prototype.autoComplete=function(a,b){var c=this;return this.$timeout(function(){var d=c.buildServerRequestObject(b);return d.requestInfo.acc=a.field,c.$http.post(b.qgridSettings.domain+b.qgridSettings.urlAutoComplete,d).then(function(a){return a.data})},0)},a.prototype.exportGrid=function(a,b){var c=this.buildServerRequestObject(b);c.requestInfo.et=a,$.fileDownload(b.qgridSettings.domain+b.qgridSettings.urlExport,{httpMethod:"POST",data:c})},a.prototype.resetGrid=function(a){return angular.forEach(a.columnDefs,function(a){a.qgridColumnSettings.searchValue=""}),this.loadGrid(a)},a.$inject=["$http","$q","$timeout","$interval","qgridExtender","qgridServerRequestBuilder","qgridDefaultQgridModel","qgridDefaultQgridSettings"],a}();a.GridService=b}(qgrid||(qgrid={})),angular.module("qgrid").service("qgridService",qgrid.GridService),angular.module("qgrid").run(["$templateCache",function(a){"use strict";a.put("src/templates/qgrid/qgrid.html","<div ng-if=qgrid.qgridSettings.isLoaded class=qgrid ng-grid=qgrid></div>")}]),angular.module("ngGrid").run(["$templateCache",function(a){"use strict";a.put("src/templates/nggrid/qgrid-datetime-cell.html",'<div class=ngCellText ng-class=col.colIndex()><span ng-cell-text="">{{row.getProperty(col.field) | date: col.colDef.qgridColumnSettings.cellFormatter.format}}</span></div>'),a.put("src/templates/nggrid/qgrid-footer.html",'<div ng-show=showFooter class=qgrid-footer ng-style=footerStyle()><div class=row style="padding:0px 10px 0px 10px"><div class=col-xs-3><span class=btn-group><button type=button class="btn btn-default btn-sm" ng-click=$parent.$parent.qgrid.qgridSettings.resetGrid()><span class="fa fa-refresh"></span></button> <button type=button class="btn btn-default btn-sm dropdown-toggle" data-toggle=dropdown ng-if=$parent.$parent.qgrid.qgridSettings.enableFooterSettings><i class="fa fa-cogs"></i> <span class=caret></span></button><ul class=dropdown-menu><li ng-if="$parent.$parent.qgrid.qgridSettings.enableAllExports || $parent.$parent.qgrid.qgridSettings.enableExcelExport"><a href=# ng-click="$parent.$parent.qgrid.qgridSettings.exportGrid(\'Excel\')">Export to Excel</a></li><li ng-if="$parent.$parent.qgrid.qgridSettings.enableAllExports || $parent.$parent.qgrid.qgridSettings.enablePDFExport"><a href=# ng-click="$parent.$parent.qgrid.qgridSettings.exportGrid(\'PDF\')">Export to PDF</a></li><li ng-if="$parent.$parent.qgrid.qgridSettings.enableAllExports || $parent.$parent.qgrid.qgridSettings.enableCSVExport"><a href=# ng-click="$parent.$parent.qgrid.qgridSettings.exportGrid(\'CSV\')">Export to CSV</a></li><li ng-repeat="footerFunction in $parent.$parent.qgrid.qgridSettings.footerActions"><a href=# ng-click="footerFunction.callback(footerFunction, $parent.$parent.qgrid)">{{footerFunction.title}}</a></li></ul></span></div><div class=col-xs-6 style=text-align:center><div class=btn-group><button ng-click=pageToFirst() ng-disabled=cantPageBackward() type=button class="btn btn-default btn-sm"><i class="fa fa-step-backward qgrid-pager-button"></i></button> <button ng-click=pageBackward() ng-disabled=cantPageBackward() type=button class="btn btn-default btn-sm" style="border-right:none !important"><i class="fa fa-chevron-left qgrid-pager-button"></i></button> <span class=qgrid-pager-input><input class=ngPagerCurrent min=1 max={{currentMaxPages}} type=number style="width:49px; height: 29.5px" ng-model=pagingOptions.currentPage ng-disabled=$parent.$parent.qgrid.qgridSettings.isLoading></span> <button ng-click=pageForward() ng-disabled=cantPageForward() type=button class="btn btn-default btn-sm" style="border-left:none !important"><i class="fa fa-chevron-right qgrid-pager-button"></i></button> <button ng-click=pageToLast() ng-disabled=cantPageToLast() type=button class="btn btn-default btn-sm"><i class="fa fa-step-forward qgrid-pager-button"></i></button> <button type=button class="btn btn-default btn-sm dropdown-toggle" data-toggle=dropdown>{{pagingOptions.pageSize}} rows <span class=caret></span></button><ul class="dropdown-menu pull-right"><li ng-repeat="size in pagingOptions.pageSizes" ng-click="pagingOptions.pageSize = size;"><a href=#>{{size}} rows</a></li></ul></div></div><div class=col-xs-3><div class=qgrid-pager-container><span><span class=ngFooterTotalItems ng-class="{\'ngNoMultiSelect\': !multiSelect}"><span class=qgrid-label>{{maxRows()}} rows total</span> <span ng-show="filterText.length > 0" class=ngLabel>({{i18n.ngShowingItemsLabel}} {{totalFilteredItemsLength()}})</span></span> <span class=ngFooterSelectedItems ng-show=multiSelect><span class=qgrid-label>{{i18n.ngSelectedItemsLabel}} {{selectedItems.length}}</span></span></span> <span tooltip-placement=right tooltip="I spin when the grid is loading!"><i class="qgrid-spinner fa fa-cog" ng-class="{\'fa-spin\' : $parent.$parent.qgrid.qgridSettings.isLoading}"></i></span></div></div></div></div>'),a.put("src/templates/nggrid/qgrid-header-row-template.html",'<div ng-style="{ height: col.headerRowHeight }" ng-repeat="col in renderedColumns" ng-class=col.colIndex() class=ngHeaderCell><div ng-header-cell=""></div></div>'),a.put("src/templates/nggrid/qgrid-pager-steppable.html",'<ul class="pagination pagination-sm qgrid-pager"><li><a href=# ng-click=pageToFirst() ng-disabled=cantPageBackward()><span class="glyphicon glyphicon-step-backward"></span></a></li><li><a href=# ng-click=pageBackward() ng-disabled=cantPageBackward()><span class="glyphicon glyphicon-chevron-left"></span></a></li><li ng-repeat="pageLink in pageLinks" ng-show=!pageLink.hidden ng-class="{\'active\' : pageLink.active}"><a href=# ng-click=setCurrentPage(pageLink.value)>{{pageLink.title}}</a></li><li><a href=# ng-click=pageForward() ng-disabled=cantPageForward()><span class="glyphicon glyphicon-chevron-right"></span></a></li><li><a href=# ng-click=pageToLast() ng-disabled=cantPageToLast()><span class="glyphicon glyphicon-step-forward"></span></a></li></ul>'),a.put("src/templates/nggrid/qgrid-searchtextbox-header-cell.html",'<div class="ngHeaderSortColumn {{col.headerClass}} qgrid-header-cell" ng-style="{\'cursor\': col.cursor}" ng-class="{ \'ngSorted\': !noSortVisible }"><div ng-click=col.sort($event) ng-class="\'colt\' + col.index" class=ngHeaderText>{{col.displayName}}</div><form class="bs-example bs-example-form" role=form><span style="display:inline-block; padding: 0px 5px 0px 5px; width: 100%"><div class=input-group style="width: 100%"><input type=text class=form-control placeholder={{col.displayName}} ng-enter=$parent.qgrid.qgridSettings.performSearch() ng-model=col.colDef.qgridColumnSettings.searchValue></div></span></form><div class=ngSortButtonDown ng-show=col.showSortButtonDown()></div><div class=ngSortButtonUp ng-show=col.showSortButtonUp()></div><div class=ngSortPriority>{{col.sortPriority}}</div><div ng-class="{ ngPinnedIcon: col.pinned, ngUnPinnedIcon: !col.pinned }" ng-click=togglePin(col) ng-show=col.pinnable></div></div><div ng-show=col.resizable class=ngHeaderGrip ng-click=col.gripClick($event) ng-mousedown=col.gripOnMouseDown($event)></div>'),a.put("src/templates/nggrid/qgrid-typeahead-header-cell.html",'<div class="ngHeaderSortColumn {{col.headerClass}} typeahead" ng-style="{\'cursor\': col.cursor}" ng-class="{ \'ngSorted\': !noSortVisible }"><div ng-click=col.sort($event) ng-class="\'colt\' + col.index" class=ngHeaderText>{{col.displayName}}</div><span style="display:inline-block; padding: 0 5px 0 5px; width: 100%"><input type=text ng-model=col.colDef.qgridColumnSettings.searchValue placeholder={{col.displayName}} ng-dblclick=openTypeAhead() qgrid-typeahead="address for address in $parent.qgrid.qgridSettings.autoComplete(col.colDef) | filter:$viewValue" qrid-typeahead-editable=true qgrid-typeahead-loading=loadingLocations class=form-control ng-enter=$parent.qgrid.qgridSettings.performSearch()></span><div class=ngSortButtonDown ng-show=col.showSortButtonDown()></div><div class=ngSortButtonUp ng-show=col.showSortButtonUp()></div><div class=ngSortPriority>{{col.sortPriority}}</div><div ng-class="{ ngPinnedIcon: col.pinned, ngUnPinnedIcon: !col.pinned }" ng-click=togglePin(col) ng-show=col.pinnable></div></div><div ng-show=col.resizable class=ngHeaderGrip ng-click=col.gripClick($event) ng-mousedown=col.gripOnMouseDown($event)></div>')}]);